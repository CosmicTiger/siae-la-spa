<div class="mb-4 flex items-center gap-2">
  <input [formControl]="search" class="input max-w-sm" placeholder="Buscar (nombre o documento)" />
  <button class="btn" (click)="openCreate()">Nuevo alumno</button>
</div>

<div class="card overflow-hidden">
  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50 text-xs uppercase text-gray-600">
      <tr>
        <th class="px-4 py-3 text-left">Nombre</th>
        <th class="px-4 py-3 text-left">Documento</th>
        <th class="px-4 py-3 text-left">Ciudad</th>
        <th class="px-4 py-3 text-left">Dirección</th>
        <th class="px-4 py-3 text-left">Activo</th>
        <th class="px-4 py-3 text-left">Acciones</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-100 bg-white text-gray-800">
      <tr *ngFor="let item of items()">
        <td class="px-4 py-3">{{ item.nombres }} {{ item.apellidos }}</td>
        <td class="px-4 py-3">{{ item.documentoIdentidad || '—' }}</td>
        <td class="px-4 py-3">{{ item.ciudad || '—' }}</td>
        <td class="px-4 py-3">{{ item.direccion || '—' }}</td>
        <td class="px-4 py-3">
          <span class="inline-flex items-center gap-2 rounded-full px-2.5 py-1 text-xs"
            [class.bg-green-100]="item.activo" [class.text-green-800]="item.activo" [class.bg-gray-100]="!item.activo"
            [class.text-gray-700]="!item.activo">
            <span class="h-2 w-2 rounded-full" [class.bg-green-500]="item.activo"
              [class.bg-gray-400]="!item.activo"></span>
            {{ item.activo ? 'Sí' : 'No' }}
          </span>
        </td>
        <td class="px-4 py-3">
          <div class="flex items-center gap-2">
            <a class="btn btn-sm btn-ghost" [routerLink]="[item.id]">Ver</a>
            <button class="btn btn-sm btn-outline" (click)="edit(item)">Editar</button>
            <button class="btn btn-sm" (click)="toggleActive(item)">
              {{ item.activo ? 'Desactivar' : 'Activar' }}
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div class="mt-3 flex items-center gap-2">
  <button class="btn-outline" (click)="prev()" [disabled]="page() === 1">Anterior</button>
  <span class="text-sm text-gray-600">Página {{ page() }} / {{ totalPages() }}</span>
  <button class="btn-outline" (click)="next()" [disabled]="page() >= totalPages()">Siguiente</button>
</div>

<!-- Modal -->
<app-student-dialog [(open)]="creating" [initial]="editing()" (closed)="onCreated($event)"></app-student-dialog>

<!-- Nested route outlet for detail modal -->
<router-outlet></router-outlet>
